<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    
    <title>WP-Astra主题常用整理 | 涛哥建站生涯的笔记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    

    

    

    

    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1640859999376.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1640859999376.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = false

    </script>

<meta name="generator" content="Hexo 6.0.0"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="/images/avatar.jpg" alt="禹小涛">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>涛哥建站生涯的笔记</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">首页</a>
                
                <a href="/archives">归档</a>
                
                <a href="/about">关于我</a>
                
            </div>
            <div class="header-menu-social">
                
            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">首页</a>
                    
                    <a href="/archives">归档</a>
                    
                    <a href="/about">关于我</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-cky5m3g4r0001ekvj49rlge6x" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      WP-Astra主题常用整理
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-01-08T09:08:10.000Z" itemprop="datePublished">2022-01-08</time>
</div>

            

            

            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <h2 id="禁止更新"><a href="#禁止更新" class="headerlink" title="禁止更新"></a>禁止更新</h2><p>wp-config.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AUTOMATIC_UPDATER_DISABLED'</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>functions文件中</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'pre_site_transient_update_core'</span><span class="token punctuation">,</span>    <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$a'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"return null;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭核心提示</span>
 
<span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'pre_site_transient_update_plugins'</span><span class="token punctuation">,</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$a'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"return null;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭插件提示</span>
 
<span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'pre_site_transient_update_themes'</span><span class="token punctuation">,</span>  <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$a'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"return null;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭主题提示</span>
 
<span class="token function">remove_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin_init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_maybe_update_core'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 禁止 WordPress 检查更新</span>
 
<span class="token function">remove_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin_init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_maybe_update_plugins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 禁止 WordPress 更新插件</span>
 
<span class="token function">remove_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin_init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_maybe_update_themes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 禁止 WordPress 更新主题</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<span id="more"></span>

<h2 id="将the-content-放到短代码中"><a href="#将the-content-放到短代码中" class="headerlink" title="将the_content()放到短代码中"></a>将the_content()放到短代码中</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">custom_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">apply_filters</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'the_content'</span><span class="token punctuation">,</span> <span class="token function">get_the_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">get_the_ID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token function">add_shortcode</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'custom_contents'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'custom_content'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="隐藏菜单以及插件"><a href="#隐藏菜单以及插件" class="headerlink" title="隐藏菜单以及插件"></a>隐藏菜单以及插件</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'all_plugins'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hide_plugins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function-definition function">hide_plugins</span><span class="token punctuation">(</span><span class="token variable">$plugins</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">// 隐藏 你好，多莉 插件</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_plugin_active</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'unlimited-elements-for-elementor-premium/unlimited-elements-pro.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$plugins</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'unlimited-elements-for-elementor-premium/unlimited-elements-pro.php'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 隐藏 post series插件</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_plugin_active</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'advanced-custom-fields-pro/acf.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$plugins</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'advanced-custom-fields-pro/acf.php'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_plugin_active</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jet-elements/jet-elements.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span> <span class="token variable">$plugins</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jet-elements/jet-elements.php'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token variable">$plugins</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'admin_menu'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">remove_menu_page</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'jet-dashboard'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">remove_menu_page</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'edit.php?post_type=acf-field-group'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//页面</span>
   <span class="token function">remove_menu_page</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'unlimitedelements'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//页面</span>
    
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="面包屑导航函数"><a href="#面包屑导航函数" class="headerlink" title="面包屑导航函数"></a>面包屑导航函数</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">dimox_breadcrumbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  
  <span class="token variable">$delimiter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&amp;raquo;'</span><span class="token punctuation">;</span>
  <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Home'</span><span class="token punctuation">;</span> <span class="token comment">//text for the 'Home' link</span>
  <span class="token variable">$currentBefore</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;span>'</span><span class="token punctuation">;</span>
  <span class="token variable">$currentAfter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;/span>'</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">is_home</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_front_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_paged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;div id="crumbs"> &lt;i class="fa fa-home">&lt;/i>  '</span><span class="token punctuation">;</span>
  
    <span class="token keyword">global</span> <span class="token variable">$post</span><span class="token punctuation">;</span>
    <span class="token variable">$home</span> <span class="token operator">=</span> <span class="token function">get_bloginfo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;a href="'</span><span class="token operator">.</span><span class="token variable">$home</span><span class="token operator">.</span><span class="token string single-quoted-string">'">'</span> <span class="token operator">.</span> <span class="token variable">$name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/a>'</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
  
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_category</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">global</span> <span class="token variable">$wp_query</span><span class="token punctuation">;</span>
      <span class="token variable">$cat_obj</span> <span class="token operator">=</span> <span class="token variable">$wp_query</span><span class="token operator">-></span><span class="token function">get_queried_object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$thisCat</span> <span class="token operator">=</span> <span class="token variable">$cat_obj</span><span class="token operator">-></span><span class="token property">term_id</span><span class="token punctuation">;</span>
      <span class="token variable">$thisCat</span> <span class="token operator">=</span> <span class="token function">get_category</span><span class="token punctuation">(</span><span class="token variable">$thisCat</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$parentCat</span> <span class="token operator">=</span> <span class="token function">get_category</span><span class="token punctuation">(</span><span class="token variable">$thisCat</span><span class="token operator">-></span><span class="token property">parent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$thisCat</span><span class="token operator">-></span><span class="token property">parent</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">get_category_parents</span><span class="token punctuation">(</span><span class="token variable">$parentCat</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span><span class="token punctuation">;</span>
      <span class="token function">single_cat_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_day</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'d'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_month</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token string single-quoted-string">''</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_year</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token function">get_the_time</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_single</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token variable">$cat</span> <span class="token operator">=</span> <span class="token function">get_the_category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$cat</span> <span class="token operator">=</span> <span class="token variable">$cat</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$cat</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token function">get_category_parents</span><span class="token punctuation">(</span><span class="token variable">$cat</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span><span class="token punctuation">;</span>
      <span class="token function">the_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_parent</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span><span class="token punctuation">;</span>
      <span class="token function">the_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_parent</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token variable">$parent_id</span>  <span class="token operator">=</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_parent</span><span class="token punctuation">;</span>
      <span class="token variable">$breadcrumbs</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$parent_id</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token function">get_page</span><span class="token punctuation">(</span><span class="token variable">$parent_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$breadcrumbs</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span> <span class="token operator">.</span> <span class="token function">get_the_title</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token operator">-></span><span class="token constant">ID</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
        <span class="token variable">$parent_id</span>  <span class="token operator">=</span> <span class="token variable">$page</span><span class="token operator">-></span><span class="token property">post_parent</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token variable">$breadcrumbs</span> <span class="token operator">=</span> <span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token variable">$breadcrumbs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$breadcrumbs</span> <span class="token keyword">as</span> <span class="token variable">$crumb</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token variable">$crumb</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$delimiter</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span><span class="token punctuation">;</span>
      <span class="token function">the_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'Search results for &amp;#39;'</span> <span class="token operator">.</span> <span class="token function">get_search_query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&amp;#39;'</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'Posts tagged &amp;#39;'</span><span class="token punctuation">;</span>
      <span class="token function">single_tag_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&amp;#39;'</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_author</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token keyword">global</span> <span class="token variable">$author</span><span class="token punctuation">;</span>
      <span class="token variable">$userdata</span> <span class="token operator">=</span> <span class="token function">get_userdata</span><span class="token punctuation">(</span><span class="token variable">$author</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'Articles posted by '</span> <span class="token operator">.</span> <span class="token variable">$userdata</span><span class="token operator">-></span><span class="token property">display_name</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
  
    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token function">is_404</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">echo</span> <span class="token variable">$currentBefore</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'Error 404'</span> <span class="token operator">.</span> <span class="token variable">$currentAfter</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get_query_var</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'paged'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_category</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_day</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_month</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_year</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_author</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string single-quoted-string">' ('</span><span class="token punctuation">;</span>
      <span class="token keyword">echo</span> <span class="token function">__</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Page'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token function">get_query_var</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'paged'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_category</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_day</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_month</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_year</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_author</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string single-quoted-string">')'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/div>'</span><span class="token punctuation">;</span>
  
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token function">add_shortcode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'breadcrumbs'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dimox_breadcrumbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="小部件Twig-模板引擎获取获取文章中第一张图为缩略图"><a href="#小部件Twig-模板引擎获取获取文章中第一张图为缩略图" class="headerlink" title="小部件Twig 模板引擎获取获取文章中第一张图为缩略图"></a>小部件Twig 模板引擎获取获取文章中第一张图为缩略图</h2><p>Twig是无法实现的，通过PHP函数才能实现<br>PHP函数放在function中</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">catch_the_image</span><span class="token punctuation">(</span> <span class="token variable">$post_content</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// global $post, $posts;</span>
    <span class="token variable">$first_img</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/&lt;img.+src=[\'"]([^\'"]+)[\'"].*>/i'</span><span class="token punctuation">,</span> <span class="token variable">$post_content</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$first_img</span> <span class="token operator">=</span> <span class="token variable">$matches</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token keyword">echo</span> <span class="token variable">$first_img</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>利用wordpress钩子函数</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">add_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auto_img'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'catch_the_image'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>图片src,在post list循环中使用</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token function">do_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auto_img'</span><span class="token punctuation">,</span> item<span class="token operator">.</span>post_list<span class="token operator">.</span><span class="token class-name">content</span><span class="token operator">|</span><span class="token class-name">wpautop</span><span class="token operator">|</span><span class="token class-name">raw</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="WordPress中PHP配置的调整"><a href="#WordPress中PHP配置的调整" class="headerlink" title="WordPress中PHP配置的调整"></a>WordPress中PHP配置的调整</h2><p>更新wp-config.php文件</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'upload_max_filesize'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'128M'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'post_max_size'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'128M'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'memory_limit'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'256M'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'max_execution_time'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'300'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'max_input_time'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'300'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>部分国外主机是更新.htaccess文件</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">php_value upload_max_filesize <span class="token number">128</span>M
php_value post_max_size <span class="token number">128</span>M
php_value memory_limit <span class="token number">256</span>M
php_value max_execution_time <span class="token number">300</span>
php_value max_input_time <span class="token number">300</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
        </div>

    </div>

    

    

    

    

    

    
<nav class="article-nav">
  
    <a href="/2022/%E5%B8%B8%E7%94%A8css%E6%94%B6%E9%9B%86.html" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">下一篇</div>
      <div class="article-nav-title">
        
          常用css收集
        
      </div>
    </a>
  
  
    <a href="/2022/hello-world.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=WP-Astra主题常用整理 - 涛哥建站生涯的笔记&url=https://book.5zzu.com/2022/WP-Astra%E4%B8%BB%E9%A2%98%E5%B8%B8%E7%94%A8%E6%95%B4%E7%90%86.html">
            <box-icon type='logo' name='twitter'></box-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=WP-Astra主题常用整理 - 涛哥建站生涯的笔记&u=https://book.5zzu.com/2022/WP-Astra%E4%B8%BB%E9%A2%98%E5%B8%B8%E7%94%A8%E6%95%B4%E7%90%86.html">
            <box-icon name='facebook-square' type='logo' ></box-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=WP-Astra主题常用整理 - 涛哥建站生涯的笔记&url=https://book.5zzu.com/2022/WP-Astra%E4%B8%BB%E9%A2%98%E5%B8%B8%E7%94%A8%E6%95%B4%E7%90%86.html&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>














</div>
                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      

    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/elementor%E5%BB%BA%E7%AB%99-%E5%8F%AF%E8%A7%86%E5%8C%96%E5%BB%BA%E7%AB%99-wordpress%E5%BB%BA%E7%AB%99/" rel="tag">elementor建站,可视化建站,wordpress建站</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/2022/%E7%BA%AFelementor%E5%81%9A%E5%88%87%E6%8D%A2%E6%8C%89%E9%92%AE.html">纯elementor做切换按钮</a>
          </li>
        
          <li>
            <a href="/2022/%E5%B8%B8%E7%94%A8css%E6%94%B6%E9%9B%86.html">常用css收集</a>
          </li>
        
          <li>
            <a href="/2022/WP-Astra%E4%B8%BB%E9%A2%98%E5%B8%B8%E7%94%A8%E6%95%B4%E7%90%86.html">WP-Astra主题常用整理</a>
          </li>
        
          <li>
            <a href="/2022/hello-world.html">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <div class="footer-wrap">
        <div class="footer-inner"> 
            涛哥建站生涯的笔记 &copy; 2022<br>
            Powered By Hexo · Theme By <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Aomori</a>
        </div>
    </div>

</footer>






<script src="/dist/build.js?1640859999376.js"></script>


<script src="/dist/custom.js?1640859999376.js"></script>









</body>

</html>